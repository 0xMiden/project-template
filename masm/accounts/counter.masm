use.miden::account
use.std::sys

const.COUNTER_SLOT=0

# Inputs: []
export.constructor
    exec.account::get_nonce

    # fails if nonce != 0
    eq.0 assert
    # => []

    exec.increment_count
    # => []
end

# Inputs: []
export.get_count
    push.COUNTER_SLOT
    # => [index]

    exec.account::get_item
    # => [count]

    exec.sys::truncate_stack
    # => []
end

# Inputs: []
export.increment_count
    push.COUNTER_SLOT
    # => [index]

    exec.account::get_item
    # => [count]

    push.1 add
    # => [count+1]

    # debug statement with client
    debug.stack

    push.COUNTER_SLOT
    # [index, count+1]

    exec.account::set_item
    # => []

    exec.sys::truncate_stack
    # => []
end
